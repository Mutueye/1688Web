<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="renderer" content="webkit">
        <meta name="description" content="1688双创智慧园区管理系统">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
        <title>1688双创智慧园区管理系统</title>
        <link rel="stylesheet" href="../css/font-awesome.min.css">
        <link rel="stylesheet" href="../css/bootstrap-datetimepicker.min.css">
        <link rel="stylesheet" href="../js/bootstrap-fileinput/css/fileinput.min.css">
        <link rel="stylesheet" href="../js/bootstrap-fileinput/css/theme.min.css">
        <link rel="stylesheet" href="../css/bootstrapValidator.min.css">
        <link rel="stylesheet" href="../css/toastr.min.css">
        <link rel="stylesheet" href="../css/index.css">
    </head>
    <body>
        <div class="container-fluid row-space-common">
            <div class="row mt-space">
                <div class="col-xs-12">
                    <div class="page-title">创业空间编辑<a class="btn btn-sm btn-theme pull-right" href="chuangye-space.html"><i class="fa fa-undo"></i>&nbsp;返回</a></div>
                </div>
                <div class="col-xs-12 row-space-10">
                    <form class="row no-bottom" id="form" name="form">
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label"> <span class="font-red-intense">*&nbsp;</span>标题：</div>
                                <input class="form-control" id="space_title" type="text" name="space_title" value="空间标题...">
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label"> <span class="font-red-intense">*&nbsp;</span>地点：</div>
                                <input class="form-control" id="address" type="text" name="address" value="空间地点...">
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label"> <span class="font-red-intense">*&nbsp;</span>面积：</div>
                                <div class="input-group">
                                    <input class="form-control" id="area" type="text" name="area" value="234">
                                    <div class="input-group-addon">平米</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label">
                                     创业空间展示图：</div>
                                <input class="form-control input-file" id="input_appendix" type="file" name="input_appendix">
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label"> <span class="font-red-intense">*&nbsp;</span>空间介绍：</div>
                                <textarea class="form-control textarea" id="space_intro" rows="3" name="space_intro">空间介绍...</textarea>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label"> <span class="font-red-intense">*&nbsp;</span>入驻条件：</div>
                                <textarea class="form-control textarea" id="condition" rows="3" name="condition">入驻条件...</textarea>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label"> <span class="font-red-intense">*&nbsp;</span>位置及联系：</div>
                                <textarea class="form-control textarea" id="location" rows="3" name="location">位置及联系...</textarea>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group cool-form-group form-group-sm">
                                <div class="cool-form-label text-right control-label"> <span class="font-red-intense">*</span>&nbsp;详细内容：</div>
                                <div class="cool-form-content ueditor-content">
                                    <script id="container" name="content" type="text/plain"></script>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="btn btn-large btn-theme" id="btn_publish"><i class="fa fa-upload"></i>&nbsp;提交申请</div>
                            <div class="btn btn-large btn-theme" id="btn_draft"><i class="fa fa-save"></i>&nbsp;暂存</div>
                            <div class="btn btn-large btn-theme" id="btn_preview"><i class="fa fa-eye"></i>&nbsp;预览</div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <script src="../js/jquery.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script src="../js/moment/moment.min.js"></script>
        <script src="../js/moment/zh-cn.js"></script>
        <script src="../js/bootstrap-datetimepicker.min.js"></script>
        <script src="../js/bootstrap-fileinput/fileinput.min.js"></script>
        <script src="../js/bootstrap-fileinput/zh.js"></script>
        <script src="../js/bootstrap-fileinput/theme.min.js"></script>
        <script src="../js/bootstrapvalidator/bootstrapValidator.min.js"></script>
        <script src="../js/bootstrapvalidator/zh_CN.js"></script>
        <script src="../js/ueditor-utf8-jsp/ueditor.config.js"></script>
        <script src="../js/ueditor-utf8-jsp/ueditor.all.min.js"></script>
        <script src="../js/toastr.min.js"></script>
        <script src="../js/BSModal.js"></script>
        <script src="../js/common.js"></script>
        <script src="../js/app.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                
                var $btn_publish = $('#btn_publish'); //按钮发布
                var $btn_draft = $('#btn_draft'); //按钮暂存
                var $btn_preview = $('#btn_preview'); //按钮预览
                
                $btn_publish.attr('disabled','disabled');
                $btn_draft.attr('disabled','disabled');
                $btn_preview.attr('disabled','disabled');
                    
                var $input_appendix = $('#input_appendix');
                var $form = $('#form');
                
                //附件上传 初始化fileinput插件
                window.commonTools.initBSFileInput($input_appendix, true, true);
                
                //实例化ueditor编辑器
                var ue = UE.getEditor('container');
                //初始化完成后，解除按钮禁用状态
                ue.ready(function(){
                    $btn_publish.attr('disabled',false);
                    $btn_draft.attr('disabled',false);
                    $btn_preview.attr('disabled',false);
                    //加载编辑内容
                    ue.setContent('<b>内容信息...</b>');
                });
                
                //发布
                $btn_publish.click(function(){
                    if(!$(this).attr('disabled')) {
                        if(checkValidation()) {
                            //此处提交数据，提交成功后，返回上级页面
                            window.location.href='chuangye-space.html';
                        }
                    } else {
                        toastr.warning('富文本编辑器未初始化完成，请稍等...');
                    }
                });
                
                //暂存
                $btn_draft.click(function(){
                    if(!$(this).attr('disabled')) {
                        if(checkValidation()) {
                            //此处提交数据，提交成功后，弹出如下提示
                            toastr.success('您编辑的内容已暂存');
                        }
                    } else {
                        toastr.warning('富文本编辑器未初始化完成，请稍等...');
                    }
                });
                
                //预览
                $btn_preview.click(function(){
                    if(!$(this).attr('disabled')) {
                        if(checkValidation()) {
                            var logoUrl = commonTools.getFilePath($("#input_appendix"));
                            if(logoUrl == '' || !logoUrl) {
                                if($input_appendix.fileinput('getPreview').content.length > 0) {
                                    logoUrl = $input_appendix.fileinput('getPreview').content[0];
                                } else {
                                    logoUrl = '../images/rcs-empty.jpg';
                                }
                            }
                            var htmlStr =   '<div class="row-space-common">' +
                                                '<div class="row">' +
                                                    '<div class="col-xs-12">' +
                                                        '<div class="orgintro-container">' +
                                                            '<div class="orgintro-logo">' +
                                                                '<img src="' + logoUrl + '">' +
                                                            '</div>' +
                                                            '<div class="orgintro-title">' + $('#space_title').val() + '</div>' +
                                                            '<div class="orgintro-content">' + 
                                                                '<p>地点：' + $('#address').val() + '&nbsp;&nbsp;&nbsp;面积：' + $('#area').val() + '平米</p>' + 
                                                                '<p>空间介绍：' + $('#space_intro').val() + '</p>' +
                                                                '<p>入驻条件：' + $('#condition').val() + '</p>' +
                                                                '<p>位置及联系：' + $('#location').val() + '</p>' +
                                                            '</div>' +
                                                        '</div>' +
                                                    '</div>' +
                                                    '<div class="col-xs-12">' +
                                                        '<div class="section-title">' +
                                                            '<div class="section-title-icon"></div>' +
                                                            '<div class="section-title-text">详细内容</div>' +
                                                        '</div>' +
                                                        '<div class="article-content">' +
                                                            ue.getContent() +
                                                        '</div>' +
                                                    '</div>' +
                                                '</div>' +
                                            '</div>';
                            BSModal.confirm({
                                title : '预览',
                                content : htmlStr,
                                width : '90%',
                                btnOK : '确定',
                                btnCancel : '',
                                maxHeight: '450px'
                            });
                        }
                    } else {
                        toastr.warning('富文本编辑器未初始化完成，请稍等...');
                    }
                });
                
                $form.bootstrapValidator({
                    fields: {
                        space_title: {
                            message: '标题验证失败',
                            validators: {
                                notEmpty: {
                                    message: '请输入标题'
                                }
                            }
                        },
                        address: {
                            message: '地点验证失败',
                            validators: {
                                notEmpty: {
                                    message: '请输入地点'
                                }
                            }
                        },
                        area: {
                            message: '面积验证失败',
                            validators: {
                                notEmpty: {
                                    message: '请输入面积'
                                }
                            }
                        },
                        space_intro: {
                            message: '空间介绍验证失败',
                            validators: {
                                notEmpty: {
                                    message: '请输入空间介绍'
                                }
                            }
                        },
                        condition: {
                            message: '入驻条件验证失败',
                            validators: {
                                notEmpty: {
                                    message: '请输入入驻条件'
                                }
                            }
                        },
                        location: {
                            message: '位置及联系验证失败',
                            validators: {
                                notEmpty: {
                                    message: '请输入位置及联系'
                                }
                            }
                        }
                    }
                });
                
                //判断必填项是否都已填入内容
                function checkValidation() {
                    if(ue.getContent().length == 0) {
                        toastr.warning('请输入详细内容');
                        return false;
                    } else {
                        var bsValidator = $form.data('bootstrapValidator');
                        bsValidator.validate();
                        var result = bsValidator.isValid();
                        if(!result) {
                            toastr.warning('您输入的表单信息验证未通过');
                        }
                        return result;
                    }
                }
                
            });
            
            
            
            
                        
                
            
            
            
            
                        
                
            
            
            
                        
                
        </script>
    </body>
</html>